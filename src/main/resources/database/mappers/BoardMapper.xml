<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.coffice.app.posts.board.BoardDAO">
  	<insert id="add" parameterType="BoardVO">
  		INSERT INTO BOARD VALUES(NULL, #{boardTitle}, #{userId}, 0, #{boardContents}, now(), 0, null)
  	</insert>
  	
  	<select id="getList" parameterType="Pager" resultType="BoardVO">
  		SELECT * FROM BOARD
  		<include refid="search"></include>
  		ORDER BY BOARD_NUM DESC
  		LIMIT #{startNum}, #{page}
  	</select>
  	
  	<select id="getTotalCount" parameterType="Pager" resultType="Long">
  		SELECT COUNT(*) FROM BOARD
  		<include refid="search"></include>
  	</select>
  	
  	<sql id="search">
  		WHERE
  			<choose>
  				<when test="kind == 'k1'">
  					BOARD_TITLE LIKE CONCAT('%', #{search}, '%') 
  				</when>
  				<when test="kind == 'k2'">
  					BOARD_CONTENTS LIKE CONCAT('%', #{search}, '%')
  				</when>
  				<otherwise>
  					BOARD_TITLE LIKE CONCAT('%', #{search}, '%') OR BOARD_CONTENTS LIKE CONCAT('%', #{search}, '%')
  				</otherwise>
  			</choose>
  		AND DELETE_STATUS = 0
  	</sql>
  	
  	<select id="getDetail" parameterType="BoardVO" resultType="BoardVO">
  		SELECT * FROM BOARD 
  		WHERE BOARD_NUM = #{boardNum}
  	</select>
  	
	<update id="delete" parameterType="BoardVO">
		UPDATE BOARD SET DELETE_STATUS = 1 WHERE BOARD_NUM = #{boardNum}
	</update>
	
	<update id="update" parameterType="BoardVO">
		UPDATE BOARD SET BOARD_TITLE = #{boardTitle}, BOARD_CONTENTS = #{boardContents} WHERE BOARD_NUM = #{boardNum}
	</update>
  </mapper>